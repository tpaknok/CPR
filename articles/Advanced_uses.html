<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="CPR">
<title>Complex models and manual priors • CPR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Complex models and manual priors">
<meta property="og:description" content="CPR">
<meta property="og:image" content="https://tpaknok.github.io/CPR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="tpaknok.github.io/CPR,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-none"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">CPR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Advanced_uses.html">Complex models and manual priors</a>
    <a class="dropdown-item" href="../articles/Empirical_multiple.html">Empirical Analyses with CPR - Multiple Functions</a>
    <a class="dropdown-item" href="../articles/Empirical_single.html">Empirical Analyses with CPR - Single Function</a>
    <a class="dropdown-item" href="../articles/Simulation.html">Simulation with CPR</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tpaknok/CPR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Complex models and manual priors</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tpaknok/CPR/blob/HEAD/vignettes/Advanced_uses.Rmd" class="external-link"><code>vignettes/Advanced_uses.Rmd</code></a></small>
      <div class="d-none name"><code>Advanced_uses.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>As INLA conducts Bayesian analyses, users must specify the priors for
different parameters, or at least you need to accept the default values.
Generally, for a mixed model, users must consider priors for the fixed
effects, random effects, as well as the distributions. Here, I
demonstrate how to manually specify prios and include other random
effects in CPR models.</p>
<p>Again let’s load the data first.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/liamrevell/phytools" class="external-link">phytools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tpaknok/CPR" class="external-link">CPR</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"KSR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"KSR_MLtree"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"KSR_EF"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">VCV_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/vcv.phylo.html" class="external-link">vcv</a></span><span class="op">(</span><span class="va">KSR_MLtree</span><span class="op">)</span> <span class="co">#species level phyologenetic covariance matrix using default (Brownian) model</span></span>
<span><span class="va">VCV_sp</span> <span class="op">&lt;-</span> <span class="va">VCV_sp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">VCV_sp</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">VCV_sp</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">VCV_comm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_comm_pair.html">get_comm_pair_r</a></span><span class="op">(</span><span class="va">KSR</span>,<span class="va">VCV_sp</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="complex-models">Complex Models<a class="anchor" aria-label="anchor" href="#complex-models"></a>
</h2>
<p>Imagine the BEF experiment in KSR has a blocked design (it doesn’t),
so we add one more column “block” in the data. Theoretically, this
blocking structure should be addressed by adding a random intercept. In
popular package such as lme4 or glmmTMB, we will use (1|block) to
represent the random intercept.</p>
<p>Generally, you might wish to control for other structures in your
data, such as spatial and temporal structures. INLA is capable of
handling all of these, and please refer to <a href="https://becarioprecario.bitbucket.io/inla-gitbook/ch-spatial.html" class="external-link">other
INLA resources</a> if you need to do so.</p>
<p>Now let’s generate a fake blcoking structure.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">KSR_EF</span><span class="op">$</span><span class="va">block</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>,<span class="fl">88</span>,replace<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="running-the-model">Running the Model<a class="anchor" aria-label="anchor" href="#running-the-model"></a>
</h2>
<p>To run a model with both phylogenetic and spatial (here as block)
random effects, just run the following.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inla_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CPR.html">CPR</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">LAI</span><span class="op">~</span><span class="va">Real.rich</span><span class="op">+</span></span>
<span>                 <span class="fu">f</span><span class="op">(</span><span class="va">comm</span>,model<span class="op">=</span><span class="st">"generic0"</span>,Cmatrix<span class="op">=</span><span class="va">Phylo</span><span class="op">)</span><span class="op">+</span></span>
<span>                 <span class="fu">f</span><span class="op">(</span><span class="va">block</span>,model<span class="op">=</span><span class="st">"iid"</span><span class="op">)</span>,</span>
<span>               priors<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>               df <span class="op">=</span> <span class="va">KSR_EF</span>,</span>
<span>               VCV_sp <span class="op">=</span> <span class="va">VCV_sp</span>,</span>
<span>               comm<span class="op">=</span><span class="va">KSR</span>,</span>
<span>               family<span class="op">=</span><span class="st">"gaussian"</span>,</span>
<span>               optim.lambda <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p>This, however, will use default priors for everything. Have a look at
the prior specifications. Note that INLA uses precision instead of
variance.</p>
<p>Run these functions to examine what priors are actually used in your
model.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inla_m</span><span class="op">$</span><span class="va">best_model</span><span class="op">$</span><span class="va">.args</span><span class="op">$</span><span class="va">control.fixed</span> <span class="co">#gaussian distribution, original scale</span></span>
<span><span class="va">inla_m</span><span class="op">$</span><span class="va">best_model</span><span class="op">$</span><span class="va">.args</span><span class="op">$</span><span class="va">control.family</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">hyper</span><span class="op">$</span><span class="va">theta1</span> <span class="co">#hyperparameter</span></span>
<span><span class="va">inla_m</span><span class="op">$</span><span class="va">best_model</span><span class="op">$</span><span class="va">all.hyper</span><span class="op">$</span><span class="va">random</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">hyper</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">prior</span> <span class="co">#hyperparameter</span></span>
<span><span class="va">inla_m</span><span class="op">$</span><span class="va">best_model</span><span class="op">$</span><span class="va">all.hyper</span><span class="op">$</span><span class="va">random</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">hyper</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">param</span> <span class="co">#hyperparameter</span></span>
<span><span class="va">inla_m</span><span class="op">$</span><span class="va">best_model</span><span class="op">$</span><span class="va">all.hyper</span><span class="op">$</span><span class="va">random</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">hyper</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">prior</span> <span class="co">#hyperparameter</span></span>
<span><span class="va">inla_m</span><span class="op">$</span><span class="va">best_model</span><span class="op">$</span><span class="va">all.hyper</span><span class="op">$</span><span class="va">random</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">hyper</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">param</span> <span class="co">#hyperparameter</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="internal-calculations-of-inla">Internal Calculations of INLA<a class="anchor" aria-label="anchor" href="#internal-calculations-of-inla"></a>
</h2>
<p>Apart from the fixed effects, which uses a gaussian distribution, all
other parameters are estimated using logGamma distribution. This is
because the internal calculations are conducted at log scale before
back-transforming them to the original scale. Therefore, the priors must
be specificed at log scale too. You can use inla.doc() to check the
internal calculations of different distributions and priors. For
gaussian distribution, use inla.doc(“Gaussian”).</p>
<p>Note that if the log-transformed hyperparameters follow
logGamma(a,b), the original hyperparameters follow Gamma(a,b). Read
inla.doc(“Gamma”) to learn more!</p>
<p>You can use other functions to get a sense of what the prior looks
like.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">0.001</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/prior%20investigation-1.png" alt="The prior for the slope estimates" width="100%"><p class="caption">
The prior for the slope estimates
</p>
</div>
</div>
<div class="section level2">
<h2 id="using-manual-priors">Using Manual Priors<a class="anchor" aria-label="anchor" href="#using-manual-priors"></a>
</h2>
<p>Let’s say we don’t like these priors and want to change it a bit. We
will create different objects storing our priors. Note that here I am
just demonstrating how to manually specify the priors and run CPR, not
the thought process to construct meaningful priors.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior.fixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prec.intercept <span class="op">=</span> <span class="fl">0.001</span>,prec <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span></span>
<span><span class="va">prior.family</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>hyper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>theta1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prior<span class="op">=</span><span class="st">"loggamma"</span>,param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4e-5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">prior.phy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prec<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prior<span class="op">=</span><span class="st">"loggamma"</span>,param<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">prior.block</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prec<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prior<span class="op">=</span><span class="st">"loggamma"</span>,param<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4e-5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Then just put all of these priors in different arguments. Notet that
for the blocking random effects, we will still use the default one.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inla_m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CPR.html">CPR</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">LAI</span><span class="op">~</span><span class="va">Real.rich</span><span class="op">+</span></span>
<span>                 <span class="fu">f</span><span class="op">(</span><span class="va">comm</span>,model<span class="op">=</span><span class="st">"generic0"</span>,Cmatrix<span class="op">=</span><span class="va">Phylo</span>,hyper<span class="op">=</span><span class="va">prior.phy</span><span class="op">)</span><span class="op">+</span></span>
<span>                 <span class="fu">f</span><span class="op">(</span><span class="va">block</span>,model<span class="op">=</span><span class="st">"iid"</span><span class="op">)</span>,</span>
<span>              priors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prior.phy<span class="op">=</span><span class="va">prior.phy</span>,prior.block<span class="op">=</span><span class="va">prior.block</span><span class="op">)</span>,</span>
<span>              df <span class="op">=</span> <span class="va">KSR_EF</span>,</span>
<span>              VCV_sp <span class="op">=</span> <span class="va">VCV_sp</span>,</span>
<span>              comm<span class="op">=</span><span class="va">KSR</span>,</span>
<span>              family<span class="op">=</span><span class="st">"gaussian"</span>,</span>
<span>              optim.lambda <span class="op">=</span> <span class="cn">T</span>,</span>
<span>              control.fixed <span class="op">=</span> <span class="va">prior.fixed</span>,</span>
<span>              control.family <span class="op">=</span> <span class="va">prior.family</span><span class="op">)</span></span></code></pre></div>
<p>You only need to specify the manual prior in . For example, if you
want to use the default prior for block, just use list(prior.phy=prior).
Note that the name of the priors shouldn’t contain the word “Phylo” - it
is designated to hold the communtiy phylogenetic covariance matrix. If
you name the prior with the word “Phylo”, an error would occur.</p>
<p>Now check the priors again!</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inla_m2</span><span class="op">$</span><span class="va">best_model</span><span class="op">$</span><span class="va">.args</span><span class="op">$</span><span class="va">control.fixed</span> <span class="co">#gaussian distribution, original scale</span></span>
<span><span class="va">inla_m2</span><span class="op">$</span><span class="va">best_model</span><span class="op">$</span><span class="va">.args</span><span class="op">$</span><span class="va">control.family</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">hyper</span><span class="op">$</span><span class="va">theta1</span> <span class="co">#hyperparameter</span></span>
<span><span class="va">inla_m2</span><span class="op">$</span><span class="va">best_model</span><span class="op">$</span><span class="va">all.hyper</span><span class="op">$</span><span class="va">random</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">hyper</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">prior</span> <span class="co">#hyperparameter</span></span>
<span><span class="va">inla_m2</span><span class="op">$</span><span class="va">best_model</span><span class="op">$</span><span class="va">all.hyper</span><span class="op">$</span><span class="va">random</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">hyper</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">param</span> <span class="co">#hyperparameter</span></span>
<span><span class="va">inla_m2</span><span class="op">$</span><span class="va">best_model</span><span class="op">$</span><span class="va">all.hyper</span><span class="op">$</span><span class="va">random</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">hyper</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">prior</span> <span class="co">#hyperparameter</span></span>
<span><span class="va">inla_m2</span><span class="op">$</span><span class="va">best_model</span><span class="op">$</span><span class="va">all.hyper</span><span class="op">$</span><span class="va">random</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">hyper</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">param</span> <span class="co">#hyperparameter</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="notes-on-priors">Notes on Priors<a class="anchor" aria-label="anchor" href="#notes-on-priors"></a>
</h2>
<p>So how should we specify our priors? Well there are a lot of debates
on that and you are encouraged to visit the literature. If you choose to
use the default ones, you have to understand what the values are. Many
studies prefer using non-informative priors to minimize their influences
on the results (i.e., the results are strongly driven by the data
instead of the priors), but there are also good reasons to use
informative priors, especially when the sample size is low. In fact this
is one of the major advantage of Bayesian analyses!</p>
<p>Note that default priors are not always non-informative! For example,
if you specify the fixed effect priors as , they might be
non-informative if you have standardized the responses and predictors,
given biological relationships are rarely that strong (like increasing
the responses by more than 1 SD when the predictors increase by 1 SD).
However, if you run the analyses in the original scale, it becomes more
tricky, because the slope can change according to the unit of the
responses and the predictors. For example, if body mass increases by
0.01kg per unit temperature, converting the unit to g will completely
change the magnitude of slope (i.e, 10gram)!</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Toby Pak Nok Tsang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

  </div></footer>
</body>
</html>
